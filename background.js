var _background=function(){"use strict";function Z(e){return e==null||typeof e=="function"?{main:e}:e}var Q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function X(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _={exports:{}};(function(e,s){(function(a,t){t(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Q,function(a){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)a.exports=globalThis.browser;else{const t="The message port closed before a response was received.",i=d=>{const l={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(l).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class A extends WeakMap{constructor(n,g=void 0){super(g),this.createItem=n}get(n){return this.has(n)||this.set(n,this.createItem(n)),super.get(n)}}const h=r=>r&&typeof r=="object"&&typeof r.then=="function",m=(r,n)=>(...g)=>{d.runtime.lastError?r.reject(new Error(d.runtime.lastError.message)):n.singleCallbackArg||g.length<=1&&n.singleCallbackArg!==!1?r.resolve(g[0]):r.resolve(g)},x=r=>r==1?"argument":"arguments",N=(r,n)=>function(u,...f){if(f.length<n.minArgs)throw new Error(`Expected at least ${n.minArgs} ${x(n.minArgs)} for ${r}(), got ${f.length}`);if(f.length>n.maxArgs)throw new Error(`Expected at most ${n.maxArgs} ${x(n.maxArgs)} for ${r}(), got ${f.length}`);return new Promise((w,y)=>{if(n.fallbackToNoCallback)try{u[r](...f,m({resolve:w,reject:y},n))}catch(o){console.warn(`${r} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),u[r](...f),n.fallbackToNoCallback=!1,n.noCallback=!0,w()}else n.noCallback?(u[r](...f),w()):u[r](...f,m({resolve:w,reject:y},n))})},O=(r,n,g)=>new Proxy(n,{apply(u,f,w){return g.call(f,r,...w)}});let k=Function.call.bind(Object.prototype.hasOwnProperty);const b=(r,n={},g={})=>{let u=Object.create(null),f={has(y,o){return o in r||o in u},get(y,o,T){if(o in u)return u[o];if(!(o in r))return;let p=r[o];if(typeof p=="function")if(typeof n[o]=="function")p=O(r,r[o],n[o]);else if(k(g,o)){let v=N(o,g[o]);p=O(r,r[o],v)}else p=p.bind(r);else if(typeof p=="object"&&p!==null&&(k(n,o)||k(g,o)))p=b(p,n[o],g[o]);else if(k(g,"*"))p=b(p,n[o],g["*"]);else return Object.defineProperty(u,o,{configurable:!0,enumerable:!0,get(){return r[o]},set(v){r[o]=v}}),p;return u[o]=p,p},set(y,o,T,p){return o in u?u[o]=T:r[o]=T,!0},defineProperty(y,o,T){return Reflect.defineProperty(u,o,T)},deleteProperty(y,o){return Reflect.deleteProperty(u,o)}},w=Object.create(r);return new Proxy(w,f)},U=r=>({addListener(n,g,...u){n.addListener(r.get(g),...u)},hasListener(n,g){return n.hasListener(r.get(g))},removeListener(n,g){n.removeListener(r.get(g))}}),he=new A(r=>typeof r!="function"?r:function(g){const u=b(g,{},{getContent:{minArgs:0,maxArgs:0}});r(u)}),z=new A(r=>typeof r!="function"?r:function(g,u,f){let w=!1,y,o=new Promise(R=>{y=function(C){w=!0,R(C)}}),T;try{T=r(g,u,y)}catch(R){T=Promise.reject(R)}const p=T!==!0&&h(T);if(T!==!0&&!p&&!w)return!1;const v=R=>{R.then(C=>{f(C)},C=>{let B;C&&(C instanceof Error||typeof C.message=="string")?B=C.message:B="An unexpected error occurred",f({__mozWebExtensionPolyfillReject__:!0,message:B})}).catch(C=>{console.error("Failed to send onMessage rejected reply",C)})};return v(p?T:o),!0}),xe=({reject:r,resolve:n},g)=>{d.runtime.lastError?d.runtime.lastError.message===t?n():r(new Error(d.runtime.lastError.message)):g&&g.__mozWebExtensionPolyfillReject__?r(new Error(g.message)):n(g)},J=(r,n,g,...u)=>{if(u.length<n.minArgs)throw new Error(`Expected at least ${n.minArgs} ${x(n.minArgs)} for ${r}(), got ${u.length}`);if(u.length>n.maxArgs)throw new Error(`Expected at most ${n.maxArgs} ${x(n.maxArgs)} for ${r}(), got ${u.length}`);return new Promise((f,w)=>{const y=xe.bind(null,{resolve:f,reject:w});u.push(y),g.sendMessage(...u)})},pe={devtools:{network:{onRequestFinished:U(he)}},runtime:{onMessage:U(z),onMessageExternal:U(z),sendMessage:J.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:J.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},$={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return l.privacy={network:{"*":$},services:{"*":$},websites:{"*":$}},b(d,pe,l)};a.exports=i(chrome)}})})(_);var Y=_.exports;const c=X(Y),E=({title:e})=>{chrome.action.setTitle({title:e})},M=({color:e})=>{chrome.action.setBadgeBackgroundColor({color:e})},S=({text:e})=>{chrome.action.setBadgeText({text:e})},W=(e,s,a,t)=>function(...i){const d=s.promiseModule;return new d((l,A)=>{s.multiArgs?i.push((...m)=>{s.errorFirst?m[0]?A(m):(m.shift(),l(m)):l(m)}):s.errorFirst?i.push((m,x)=>{m?A(m):l(x)}):i.push(l),Reflect.apply(e,this===a?t:this,i)})},j=new WeakMap;function ee(e,s){s={exclude:[/.+(?:Sync|Stream)$/],errorFirst:!0,promiseModule:Promise,...s};const a=typeof e;if(!(e!==null&&(a==="object"||a==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${e===null?"null":a}\``);const t=(l,A)=>{let h=j.get(l);if(h||(h={},j.set(l,h)),A in h)return h[A];const m=b=>typeof b=="string"||typeof A=="symbol"?A===b:b.test(A),x=Reflect.getOwnPropertyDescriptor(l,A),N=x===void 0||x.writable||x.configurable,k=(s.include?s.include.some(b=>m(b)):!s.exclude.some(b=>m(b)))&&N;return h[A]=k,k},i=new WeakMap,d=new Proxy(e,{apply(l,A,h){const m=i.get(l);if(m)return Reflect.apply(m,A,h);const x=s.excludeMain?l:W(l,s,d,l);return i.set(l,x),Reflect.apply(x,A,h)},get(l,A){const h=l[A];if(!t(l,A)||h===Function.prototype[A])return h;const m=i.get(h);if(m)return m;if(typeof h=="function"){const x=W(h,s,d,l);return i.set(h,x),x}return h}});return d}var se=()=>{try{let e=(globalThis.navigator?.userAgent).match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(e[1]==="Chrome")return parseInt(e[2])<100||globalThis.chrome.runtime?.getManifest()?.manifest_version===2}catch{return!1}return!1},te=class{#r;#e;get primaryClient(){return this.#e}#s;get secondaryClient(){return this.#s}#n;get area(){return this.#n}get hasWebApi(){try{return typeof window<"u"&&!!window.localStorage}catch(e){return console.error(e),!1}}#t=new Map;#a;get copiedKeySet(){return this.#a}isCopied=e=>this.hasWebApi&&(this.allCopied||this.copiedKeySet.has(e));#i=!1;get allCopied(){return this.#i}getExtStorageApi=()=>globalThis.browser?.storage||globalThis.chrome?.storage;get hasExtensionApi(){try{return!!this.getExtStorageApi()}catch(e){return console.error(e),!1}}isWatchSupported=()=>this.hasExtensionApi;keyNamespace="";isValidKey=e=>e.startsWith(this.keyNamespace);getNamespacedKey=e=>`${this.keyNamespace}${e}`;getUnnamespacedKey=e=>e.slice(this.keyNamespace.length);constructor({area:e="sync",allCopied:s=!1,copiedKeyList:a=[]}={}){this.setCopiedKeySet(a),this.#n=e,this.#i=s;try{this.hasWebApi&&(s||a.length>0)&&(this.#s=window.localStorage)}catch{}try{this.hasExtensionApi&&(this.#r=this.getExtStorageApi(),se()?this.#e=ee(this.#r[this.area],{exclude:["getBytesInUse"],errorFirst:!1}):this.#e=this.#r[this.area])}catch{}}setCopiedKeySet(e){this.#a=new Set(e)}rawGetAll=()=>this.#e?.get();getAll=async()=>{let e=await this.rawGetAll();return Object.entries(e).filter(([s])=>this.isValidKey(s)).reduce((s,[a,t])=>(s[this.getUnnamespacedKey(a)]=t,s),{})};copy=async e=>{let s=e===void 0;if(!s&&!this.copiedKeySet.has(e)||!this.allCopied||!this.hasExtensionApi)return!1;let a=this.allCopied?await this.rawGetAll():await this.#e.get((s?[...this.copiedKeySet]:[e]).map(this.getNamespacedKey));if(!a)return!1;let t=!1;for(let i in a){let d=a[i],l=this.#s?.getItem(i);this.#s?.setItem(i,d),t||=d!==l}return t};rawGet=async e=>this.hasExtensionApi?(await this.#e.get(e))[e]:this.isCopied(e)?this.#s?.getItem(e):null;rawSet=async(e,s)=>(this.isCopied(e)&&this.#s?.setItem(e,s),this.hasExtensionApi&&await this.#e.set({[e]:s}),null);clear=async(e=!1)=>{e&&this.#s?.clear(),await this.#e.clear()};rawRemove=async e=>{this.isCopied(e)&&this.#s?.removeItem(e),this.hasExtensionApi&&await this.#e.remove(e)};removeAll=async()=>{let e=await this.rawGetAll(),s=Object.keys(e);await Promise.all(s.map(this.rawRemove))};watch=e=>{let s=this.isWatchSupported();return s&&this.#o(e),s};#o=e=>{for(let s in e){let a=this.getNamespacedKey(s),t=this.#t.get(a)?.callbackSet||new Set;if(t.add(e[s]),t.size>1)continue;let i=(d,l)=>{if(l!==this.area||!d[a])return;let A=this.#t.get(a);if(!A)throw new Error(`Storage comms does not exist for nsKey: ${a}`);Promise.all([this.parseValue(d[a].newValue),this.parseValue(d[a].oldValue)]).then(([h,m])=>{for(let x of A.callbackSet)x({newValue:h,oldValue:m},l)})};this.#r.onChanged.addListener(i),this.#t.set(a,{callbackSet:t,listener:i})}};unwatch=e=>{let s=this.isWatchSupported();return s&&this.#l(e),s};#l(e){for(let s in e){let a=this.getNamespacedKey(s),t=e[s],i=this.#t.get(a);i&&(i.callbackSet.delete(t),i.callbackSet.size===0&&(this.#t.delete(a),this.#r.onChanged.removeListener(i.listener)))}}unwatchAll=()=>this.#g();#g(){this.#t.forEach(({listener:e})=>this.#r.onChanged.removeListener(e)),this.#t.clear()}async getItem(e){return this.get(e)}async setItem(e,s){await this.set(e,s)}async removeItem(e){return this.remove(e)}},P=class extends te{get=async e=>{let s=this.getNamespacedKey(e),a=await this.rawGet(s);return this.parseValue(a)};set=async(e,s)=>{let a=this.getNamespacedKey(e),t=JSON.stringify(s);return this.rawSet(a,t)};remove=async e=>{let s=this.getNamespacedKey(e);return this.rawRemove(s)};setNamespace=e=>{this.keyNamespace=e};parseValue=async e=>{try{if(e!==void 0)return JSON.parse(e)}catch(s){console.error(s)}}};const K=e=>e.endsWith("/")?e.slice(0,-1):e,I=new P,re="http://127.0.0.1:11434",ne=async()=>await I.get("urlRewriteEnabled")??!1,ae=async()=>{const e=await I.get("rewriteUrl");return!e||e.trim()===""?re:e},ie=async()=>{const[e,s]=await Promise.all([ne(),ae()]);return{isEnableRewriteUrl:e,rewriteUrl:s}},oe=async()=>{const e=await I.get("customOllamaHeaders");return e||[]},le=async()=>{const e=await oe(),s={};for(const a of e)s[a.key]=a.value;return s},D=async function(e,s="ollama"){if(c.runtime&&c.runtime.id){const{isEnableRewriteUrl:a,rewriteUrl:t}=await ie();{const i=new URL(e),d=[i.hostname];let l=`${i.protocol}//${i.hostname}`;a&&t&&s==="ollama"&&(l=t);const A=[{id:1,priority:1,condition:{requestDomains:d},action:{type:"modifyHeaders",requestHeaders:[{header:"Origin",operation:"set",value:l}]}}];await c.declarativeNetRequest.updateDynamicRules({removeRuleIds:A.map(h=>h.id),addRules:A})}}};new P;const q=async(e,s)=>{const a={...s},t=await le();return a.headers={...t,...a?.headers},fetch(e,a)},ge=new P;new P({area:"local"});const V="http://127.0.0.1:11434",G=async()=>{const e=await ge.get("ollamaURL");return!e||e.length===0?(await D(V),V):(await D(K(e)),e)},me=async()=>{try{const e=await G(),s=await q(`${K(e)}`);if(!s.ok)throw new Error(s.statusText);return!0}catch(e){return console.error(e),!1}},ce=(e,s)=>(e/s*100).toFixed(0)+"%",H=()=>{S({text:""}),E({title:""})},Ae=async(e,s)=>{e+="/api/pull";const t=(await q(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:s,stream:!0})})).body?.getReader(),i=new TextDecoder;let d=!0;for(;t;){const{done:l,value:A}=await t.read();if(l)break;const h=i.decode(A);try{const m=JSON.parse(h.trim());m.total&&m.completed?(S({text:ce(m.completed,m.total)}),M({color:"#0000FF"})):(S({text:"ðŸ‹ï¸â€â™‚ï¸"}),M({color:"#FFFFFF"})),E({title:m.status}),m.status==="success"&&(d=!0)}catch(m){console.error(m)}}d?(S({text:"âœ…"}),M({color:"#00FF00"}),E({title:"Model pulled successfully"})):(S({text:"âŒ"}),M({color:"#FF0000"}),E({title:"Model pull failed"})),setTimeout(()=>{H()},5e3)},ue=Z({main(){let e=!1;c.runtime.onMessage.addListener(async t=>{if(t.type==="sidepanel")await c.sidebarAction.open();else if(t.type==="pull_model"){const i=await G();await me()||(S({text:"E"}),M({color:"#FF0000"}),E({title:"Ollama is not running"}),setTimeout(()=>{H()},5e3)),await Ae(i,t.modelName)}}),c.runtime.onConnect.addListener(t=>{t.name==="pgCopilot"&&(e=!0,t.onDisconnect.addListener(()=>{e=!1}))}),chrome.action.onClicked.addListener(t=>{chrome.tabs.create({url:chrome.runtime.getURL("/options.html")})});const s={webUi:c.i18n.getMessage("openOptionToChat"),sidePanel:c.i18n.getMessage("openSidePanelToChat")},a={webUi:"open-web-ui-pa",sidePanel:"open-side-panel-pa"};c.contextMenus.create({id:a.sidePanel,title:s.sidePanel,contexts:["page","selection"]}),c.contextMenus.create({id:"summarize-pa",title:c.i18n.getMessage("contextSummarize"),contexts:["selection"]}),c.contextMenus.create({id:"explain-pa",title:c.i18n.getMessage("contextExplain"),contexts:["selection"]}),c.contextMenus.create({id:"rephrase-pa",title:c.i18n.getMessage("contextRephrase"),contexts:["selection"]}),c.contextMenus.create({id:"translate-pg",title:c.i18n.getMessage("contextTranslate"),contexts:["selection"]}),c.contextMenus.create({id:"custom-pg",title:c.i18n.getMessage("contextCustom"),contexts:["selection"]}),c.contextMenus.onClicked.addListener(async(t,i)=>{t.menuItemId==="open-side-panel-pa"?chrome.sidePanel.open({tabId:i.id}):t.menuItemId==="open-web-ui-pa"?c.tabs.create({url:c.runtime.getURL("/options.html")}):t.menuItemId==="summarize-pa"?(chrome.sidePanel.open({tabId:i.id}),setTimeout(async()=>{await c.runtime.sendMessage({from:"background",type:"summary",text:t.selectionText})},e?0:5e3)):t.menuItemId==="rephrase-pa"?(chrome.sidePanel.open({tabId:i.id}),setTimeout(async()=>{await c.runtime.sendMessage({type:"rephrase",from:"background",text:t.selectionText})},e?0:5e3)):t.menuItemId==="translate-pg"?(chrome.sidePanel.open({tabId:i.id}),setTimeout(async()=>{await c.runtime.sendMessage({type:"translate",from:"background",text:t.selectionText})},e?0:5e3)):t.menuItemId==="explain-pa"?(chrome.sidePanel.open({tabId:i.id}),setTimeout(async()=>{await c.runtime.sendMessage({type:"explain",from:"background",text:t.selectionText})},e?0:5e3)):t.menuItemId==="custom-pg"&&(chrome.sidePanel.open({tabId:i.id}),setTimeout(async()=>{await c.runtime.sendMessage({type:"custom",from:"background",text:t.selectionText})},e?0:5e3))}),c.commands.onCommand.addListener(t=>{switch(t){case"execute_side_panel":chrome.tabs.query({active:!0,currentWindow:!0},async i=>{const d=i[0];chrome.sidePanel.open({tabId:d.id})});break}})},persistent:!0});function we(){}function F(e,...s){}const de={debug:(...e)=>F(console.debug,...e),log:(...e)=>F(console.log,...e),warn:(...e)=>F(console.warn,...e),error:(...e)=>F(console.error,...e)};let L;try{L=ue.main(),L instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw de.error("The background crashed on startup!"),e}return L}();
_background;
